package year2020

val test =
  """..##.......
    |#...#...#..
    |.#....#..#.
    |..#.#...#.#
    |.#...##..#.
    |..#.##.....
    |.#.#.#....#
    |.#........#
    |#.##...#...
    |#...##....#
    |.#..#...#.#""".stripMargin

val input =
  """.....#.##......#..##..........#
    |##.#.##..#............##....#..
    |......###...#..............#.##
    |.....#..##.#..#......#.#.#..#..
    |..#.......###..#..........#.#..
    |..#..#.##.......##.....#....#..
    |.##....##....##.###.....###..#.
    |..##....#...##..#....#.#.#.....
    |.....##..###.##...............#
    |#.....#..#....#.##...####..#...
    |#......#.#....#..#.##....#..#.#
    |##.#...#.#............#......#.
    |.#####.......#..#.#....#......#
    |..#.#....#.#.##...#.##...##....
    |.....#.#...#..####.##..#.......
    |#....#...##.#.#.##.#..##.....#.
    |##.##...#....#...#......#..##..
    |....##...#..#.#...#.#.#.....##.
    |..#....##......##....#.#....#..
    |#..#....#....###..#.##....#.#.#
    |..#.#####..##....#....#.....##.
    |.#...##.......#...#....#.#...##
    |#.#.#.##.......#.....#.#.#....#
    |.#.#.....#.......#.......##....
    |.#......#....#....#.......##...
    |#......#.....#......#..#..#....
    |#.#...#...#....##....#.#...#..#
    |....#.....##...#...#..#.#......
    |..#......#..........#...#.#....
    |..#..#......####..##...###.....
    |.#.....#...##...#.##........###
    |#.#....#..#....#..#.....#.#..#.
    |...##.##.#.#.##...#.....#......
    |##....#.#.#...####.#.#.#.#.....
    |.##.........#..#..###..........
    |..##.###.#..#..#....##.....#...
    |##........#..###....#.#..#..#..
    |....#.#.......##..#.#.#.#......
    |....##.....#.........##.......#
    |..#........##.#.........###..##
    |....#..................##..#...
    |#...#.#..###..#.....#..#..#...#
    |..#..#.##..#..#.......#.......#
    |.....#..##..#....##...........#
    |..##...#........#...#.#.......#
    |.........#.#..#.#..#.##.#.###..
    |....#...#..#..#......##....#.#.
    |..#..#.#....#....#..#.####..##.
    |##....#.....#......##.###.#..#.
    |#..#..##..###......#.#.#.#...#.
    |.......#..##..##...#...#..#....
    |..#.###.#...#....#.##.#.....##.
    |.#.#.......##...##...##....#...
    |#...#.#.#...#.####..#..##......
    |###..#.##..#..........#...#....
    |##.#.........#..##......####...
    |..##.#..#....#.##..............
    |...#....#.......###............
    |...#.....##....#.#.#.#.......##
    |###.###...#...#...###.##...##..
    |#.#....#.##..#.....#.....##.#..
    |...#....#....#.........#....#.#
    |##.#....#........#..#..##.#....
    |.#.#..#.......#...##.......#...
    |.##...##........#....#.#..#....
    |....#..#.##.###.....#.#........
    |.#.#...#.#..#.....#.........#..
    |.......#.#.#..##....#.........#
    |.##...#....#..#...#........#..#
    |....#....#..#.#..#.#.#....##.##
    |..##....#.....##..#.#...#...#..
    |#.##.........#.....#.......#.##
    |...#...##.#.#..........#......#
    |###...#.....#..#.......#####..#
    |#.####...##.#.#..#...#.........
    |.##.....#.....##..#...##.##....
    |.........###...#......##....###
    |.#....##...###.#..#...##..#.#.#
    |.......#.......#.#...##.#......
    |.....#.#........#..##.....##...
    |....#.#.........##.#...##..#.#.
    |#..#..#.##..#.##.##.....##.###.
    |..##.........###...#....#....#.
    |.###...#..#.##...........#.....
    |#..##..........#..........#....
    |.....#.#....#..##..#...#.#....#
    |..#.....#.#....#...##.##.......
    |##.....##........#....#..##....
    |.#..#.#.........#..#..#........
    |.............##....#....#..#...
    |....##....#..#.#.##....###.##.#
    |.###..#.....#..#..##..#..##..#.
    |...#..###.......#.#....#..###..
    |#.#..#.....#...#......#........
    |#..#..............###.#......#.
    |..#....##.#....#.##.#.#...#....
    |.........##..#...#.#.......#...
    |........#...#.#....#.....##..#.
    |...#.##..#..#..###..#..#......#
    |.....####......#...#....#...#.#
    |...###.#.#......#....#.......#.
    |#...##.#....#....##....##.###..
    |.......##...##.....#.##.#..#..#
    |.....#.#............##...#.####
    |.##..#.#.#.#..#.#.#.....#.##...
    |.#..####...#.#....#.....#..#...
    |....##..#.#...#..#....#.#......
    |...#......###..#..###..#.....#.
    |.#.#.#..##....#...##..#.....#..
    |###....#....#...##.....#...#...
    |#.##....#......#...###.........
    |.#..#.#...#..#....#....#....#..
    |...............##...####..#..#.
    |#.#...........####..#...##.....
    |##.#....#........#......#...##.
    |......#...#...#....#....#.....#
    |#......#.............#....###..
    |.#...#...##.....#...##.##..#...
    |..#.#......#.#........#........
    |.......#..#.#...##..#.#.#......
    |..##...#.##........#....#.#...#
    |.....#..#..#........#.#......##
    |....#.#...##............##....#
    |.#.#....#.#.#...#...#.##.....#.
    |#.#.##...#....#.#.#..#.##..#.#.
    |.........####..#...#...#.......
    |#..#..####......#..##..#...#...
    |.........##..................#.
    |.....##.#..##.#.#...#......##..
    |...#....#....#.#.....#...#..#.#
    |#...##.#...##...........#..#...
    |#..........#.#..#..#.##..#..#.#
    |.#...#.##...#.#.#..#.......##..
    |.........#...........#..#..#...
    |.##...##....#.#......#........#
    |#.#...........#....#.......#...
    |##.#.#.......#...###......##..#
    |...###..#.##..##.#.#.......#...
    |.#...#..##.#...#........#.....#
    |...#.......#..#..........#.#...
    |..#.#.#.#.....#.#.......#..#..#
    |#.##.....#..##...#..###.#....#.
    |.......#...........#...#....###
    |.......#..#...#.............#..
    |#.....###.......#...#........#.
    |.#..#..#..#...........#........
    |....#.#...#.#.##.#.#....#.##..#
    |.......#..##...##...#...#......
    |...#.....##.###...#.#...##....#
    |#..#....#...##......#....##....
    |#.#.......#....#.###.##..#..#..
    |..##...........#...#....#......
    |.#........#.....#..#..#...#..##
    |.....#.#.#..#.......#....#.....
    |#..#.#......#......##....#.....
    |##.....................##......
    |.##........###..#.........#...#
    |........#.........#..#.........
    |.#.##....#.....#...#.........##
    |....##......#.........#........
    |...#.#..#...##.##.#.#..####....
    |..##...........##.#.#....#.....
    |.#.....#.#...#..#.......#....#.
    |....#...#......##...#...##.#..#
    |....#..##....#..#.........##.#.
    |..##...##.##....#....##.###...#
    |..#....##..##.#.#.#...#......#.
    |##...#.........#...........#...
    |.##....##.#.....#...#.......#..
    |..........##.###.##....###....#
    |..........#..##..#....#.#.##.##
    |........##.#...#.#.#.#...###.#.
    |.#......#.#.#...###.#.#.#......
    |.........#......#......#...#..#
    |......#.....#.##....##.#####..#
    |..#..##...###.#..........#.#.#.
    |.#..#....###.#...#..#....#...##
    |...................#..........#
    |....###.....#...##......#.....#
    |#.....#..##.....#.#..........#.
    |..#.......##.#....#..#.##.#...#
    |........##.#..###..#......##...
    |#...........##.#...###..#....#.
    |....#...........#.....#.#...#..
    |.##..#.#...#...#.##...#..#.....
    |#........#.#.#.#.#.#...........
    |#..#.....#..#..#.##....#....#.#
    |..#............##....#.#.##...#
    |.....###.#....#.#......#.###...
    |...#.....#.#.................#.
    |..#...##..#.#...#...#...#.....#
    |.##.#........#..#....##..#..##.
    |.#..........#...#.#..#..#.#....
    |#.......##.........#.##..#.####
    |.#..............#.......##.....
    |#......#.##..........#..#......
    |..##...#...#.#...#............#
    |.##.##..##..##........##.....#.
    |.....#..#.....##...............
    |.#..#...##...#...#.....#.......
    |#......#...#.......#..##.###.##
    |###..##......##......###....#..
    |....#..........#...#.##.#.....#
    |.........#....#..#..#.#..##....
    |.....#.....#...........#......#
    |.#.......#...#....##...#.##...#
    |..##.#..............#..#...#.#.
    |.#..####.#.........#....#....#.
    |..###.#...#..#......#.......###
    |.#.#..##...###...#...#.#...#.#.
    |...#..##..###.#..#.....#.##....
    |#...###.#...##.....####.....#..
    |.#.##...#..#.#..##.....#.......
    |...#.##.....##.....#....#......
    |.#...##.....#..###..#..........
    |..........#...#.....#....##.#..
    |.......#...#...#...#........#..
    |#....##..#...#..##.#.#.....#...
    |.#.#..............#..#....#....
    |.####.#.#.###......#...#.#....#
    |.#...#...##.#...............#.#
    |...#.......##...#...#....##....
    |#..........###.##..........##.#
    |.......#...#....#.#..#.#....#..
    |....#.##.#...###..#..##.##.....
    |..#.#.#......#.#.......###.....
    |#..................#.##....#...
    |#.....#..#.#.#..#...#.........#
    |..#..#...#.#.##........#.......
    |#..#.#..#..........###...#.#...
    |.......#.##....#........##.#...
    |.####.#.#...#.#...##.##.....###
    |........#.#...#.#..##...##.....
    |....##.##......#.##.........#..
    |.#..#...#.#...........#........
    |.......#..........#....#...#...
    |..###.#.###..#..#.....#..##....
    |.#..........#.......##...#.....
    |.#.....#...#........#...#.##..#
    |.#..#.......#..#.......#.#.#...
    |....#..##.#...##...#.#....#....
    |.....#.........#..#..#....#....
    |..#.#..##....#..#..##.#.#.....#
    |........#.#...###....#.#.#.....
    |.#.....#.......#..###.#........
    |.......#...#.#...#...##........
    |##.............#.#.....#.#..#..
    |.#....#.......#.#.......#..##..
    |#.....#........#..##..##.......
    |...........#.........###......#
    |....#.##...#.#...#...#....#..##
    |......#..##......#......#.##.#.
    |......##....####...###...#.....
    |#....#..........#.#.##.....#..#
    |....#.#...........#.#.#.#.#...#
    |....####.....##...#..##..#...#.
    |#....#.###..###.....#..###.....
    |..##.........#......#...##.#...
    |..#.....#.#...#.##.#...#..###.#
    |..#.##..##........#.......#.###
    |.....#..........#.....#....#...
    |.......##..##..###.......#####.
    |..###......#.#....###....##...#
    |#..##.....#..###...#.....##.##.
    |#..#..##.##.###.####.##.#......
    |.#.#......#.##......#..#......#
    |..###.....#.#......#.#.####....
    |#..............#..#.#...#.###..
    |...#..#.##..........##.#...#.##
    |.#.#.#.........#....#.#..#.....
    |..#.##..#...#..#...#......#....
    |.......#...#.##.#.#..#...##..#.
    |..........#.####...#........#.#
    |....#...#....##.#.........#.#..
    |##.#..#.......###....#..#..#.#.
    |..##.....#..#.#.#.####......#..
    |.#.....#..........#..#..#.#....
    |......#.#.......#.#...#..#..#..
    |...#...............#....#...#..
    |##.......#.........#.......#...
    |...#.......###...#.#...#.......
    |#...###....#....##....#....#...
    |...#....##..#.#.............##.
    |.....#.#.#..#......#...#.#..#..
    |.##....#..##..#####..##.....##.
    |....##.#.#..#.....#.#...#......
    |...#.....##.#.#..##..#.#.......
    |.......#..#..#..........#......
    |.......#...#..#.........#.##...
    |..#..#..#...##..#.#....#......#
    |..#....#...#.#......#........#.
    |.#...#..#...#.#..........#.....
    |#..#...####..#......##.##.#.#..
    |.#...#.#...#.#.....#..##.#.....
    |..#.##.#......#.........##...#.
    |###..............#.............
    |...#...###....#..#.............
    |.##....#......#..#.....#..#..#.
    |.#..........#.....##...#..#....
    |....##..#.#......###.##......#.
    |.#..##.#.##.#...##.#......###.#
    |#..###.#...###..#........#.#...
    |#..#.#.#..#...###.##.##..#..#..
    |#.#..#....#.........##......#..
    |....###.....###....#...........
    |....#..##.##....##..#.....#....
    |.#.....#....####...#..##.#..###
    |.........##..#......#.#...##...
    |.##.......#.....#.###.#..#.#..#
    |.....#.#...###.....#......####.
    |##.#...#......#.#.#..#.####...#
    |.#.##.....#..#..#.............#
    |.#..###..#..#......#..##......#
    |.......#.#........##.....#.#...
    |#....#...#..###..#.#.....#.##..
    |.##.....#.#....###..#.....##...
    |...##....#....#...#....#.#.#...
    |#####..#...........###....#...#
    |.#.......##.##.....#....#......
    |.#..#.#...#..#......#...#..#.#.
    |....#.....##...#####..#...#...#
    |###.##...#.#............#....#.
    |.....#...#........##.........#.""".stripMargin

val navigations = List(Point(1, 1), Point(3, 1), Point(5, 1), Point(7, 1), Point(1, 2))

case class Grid(rows: Int, cols: Int, grid: String)

case class Point(x: Int, y: Int)

def toGrid(input: String): Grid =
  Grid(input.lines().count().toInt, input.indexOf("\n"), input.replace("\n", ""))

def countTrees(grid: Grid, move: Point) =
  (0 until grid.rows by move.y).count { y => grid.grid(y * grid.cols + ((y * (move.x.toDouble / move.y.toDouble)).toInt % grid.cols)) == '#' }

def countTrees2 = countTrees.curried(toGrid(input))

object Day03 {
  def main(args: Array[String]): Unit =
    // part 1
    println(countTrees2(Point(3, 1)))

    // part 2
    println(navigations.map(countTrees2).map(_.toLong).product)
}
